{"author":"gastown/crew/jack","created_at":"2026-01-14T02:15:49Z","id":1,"issue_id":"gt-f6mkz","text":"## Refinements from discussion\n\n### gt commit wrapper (not hooks)\n\nA `gt commit` wrapper command is cleaner than git hooks:\n- Single implementation point\n- No per-repo hook installation\n- Easy to evolve (validation, conventions)\n- Agents already live in gt namespace\n- All roles that commit use it\n\n### Configurable email domain\n\nTown-level config for custom domains:\n\n```yaml\n# ~/.town/config.yaml\nagent_email_domain: acme.com  # default: gastown.local\n```\n\nPattern: `{name}@{role}.{rig}.{domain}`\n\nExamples:\n- Default: `jack@crew.gastown.gastown.local`\n- Custom:  `jack@crew.gastown.acme.com`\n\nBenefits:\n- Companies get branded attribution\n- Avoids .local TLD quirks\n- Aligns with federation (hop://acme.com matches *@acme.com)"}
{"author":"beads/crew/emma","created_at":"2026-01-19T19:37:45Z","id":3,"issue_id":"gt-gow8b","text":"## Current Implementation (2026-01-19)\n\nWhat exists:\n- gt tap guard pr-workflow - blocks PRs and feature branches\n- Hook configs in 4 settings files: beads/{crew,polecats}, gastown/{crew,polecats}\n- Missing from: rig roots, witness, refinery, deacon (7 files)\n\nThe guard works by:\n1. Detecting Gas Town context (env vars or /crew/, /polecats/ in path)\n2. Exiting 2 to BLOCK when in agent context\n3. Allowing operation for humans outside Gas Town\n\nJoe's shell script hook (not yet integrated):\n- Need to find and document what it does\n- Decide if it should become gt tap command or stay as script"}
{"author":"gastown/crew/max","created_at":"2026-01-19T22:59:10Z","id":6,"issue_id":"gt-y1uvb","text":"Phase 1 complete: Config-based role system implemented.\n\n**New files:**\n- `internal/config/roles.go` - RoleDefinition types, LoadRoleDefinition() with layered override resolution (builtin → town → rig)\n- `internal/config/roles/*.toml` - 7 embedded role definitions (mayor, deacon, dog, witness, refinery, polecat, crew)\n- `internal/config/roles_test.go` - Unit tests for loading, expansion, duration parsing\n\n**New command:**\n- `gt role def \u003crole\u003e` - Displays effective role configuration\n\n**Design decisions:**\n- Used TOML (not YAML) to match existing config patterns\n- Added ToLegacyRoleConfig() for backward compat with existing daemon code\n- Duration type with UnmarshalText for clean TOML parsing\n\nReady for Phase 2: Switch daemon to use LoadRoleDefinition() instead of role beads."}
{"author":"gastown/crew/max","created_at":"2026-01-19T23:16:46Z","id":7,"issue_id":"gt-y1uvb","text":"Phase 2 complete: Daemon now uses config-based roles.\n\n**Changes:**\n- `getRoleConfigForIdentity()` now uses `config.LoadRoleDefinition()` instead of reading role beads\n- Layered override resolution: builtin → town → rig\n- Backward compatible: returns `beads.RoleConfig` format for existing daemon code\n- Updated integration tests to test config-based behavior instead of role bead behavior\n\nAll daemon and config tests pass. Ready for Phase 3: Clean up role beads."}
{"author":"gastown/crew/max","created_at":"2026-01-19T23:37:27Z","id":8,"issue_id":"gt-y1uvb","text":"Phase 3 complete: Role beads cleanup.\n\n**Changes:**\n- Removed role bead creation from `gt install` - roles are now config-based\n- Removed `gt migrate-agents` command (no longer needed)\n- Updated `gt doctor` role check to validate config files instead of role beads\n- Removed `RoleBead` field from `AgentFields` struct\n- Marked `beads_role.go` as deprecated\n\nAll builds pass. Phase 4 (documentation) is optional."}
{"author":"gastown/crew/max","created_at":"2026-02-28T02:25:43Z","id":9,"issue_id":"gt-pr-sheriff","text":"## Sheriff Run 2026-02-27 (Run 2)\n\n**Easy-wins merged**: 2\n- PR #2135 (l0g1x): fix(tmux) reset window-size after WakePane — squash merged\n- PR #2138 (l0g1x): fix(patrol) remove --root-only flag — squash merged\n\n**Needs rebase (easy-win blocked)**: 1\n- PR #2121 (seanbearden): golangci-lint fixes — conflict in doctor_dog.go\n\n**Needs crew review**: 7\n- PR #2134, #2125, #2128, #2114, #2088, #2081, #2136\n\n**Needs human**: 4\n- PR #2132 (Guardian), #2068 (telemetry), #2018 (upstream-url), #2008 (context-budget)\n\n**Skipped (draft)**: 5\n"}
{"author":"gastown/crew/max","created_at":"2026-02-28T02:39:34Z","id":10,"issue_id":"gt-pr-sheriff","text":"## Sheriff Run 2026-02-27 (session 2)\n\n**Closed (already on main)**: 3\n- PR #2138 (l0g1x): fix(patrol) remove --root-only — closed (already on main as e5248e0f)\n- PR #2135 (l0g1x): fix(tmux) reset window-size — closed (already on main as 65d4c9d2)\n- PR #2121 (seanbearden): fix golangci-lint errors — closed (already on main as dbe49997)\n\n**Assigned to crew**: 7\n- PR #2125 → george: mail auto-nudge\n- PR #2114 → dennis: convoy recovery sweep\n- PR #2128 → jack: daemon clear-backoff\n- PR #2134 → mel: doctor redirect repair\n- PR #2088 → tom: quota multi-socket scanning\n- PR #2081 → gus: test Dolt PID bridge\n- PR #2018 → joe: upstream-url support\n\n**Left for human**: 4\n- PR #2132: Guardian Phase 1 (+2623, 19 files)\n- PR #2068: OTel telemetry (+2353, 29 files)\n- PR #2136: doctor workDir fix (+661, 10 files)\n- PR #2008: context-budget tap guard (+11950, 131 files)\n\n**Skipped**: 5 drafts, 3 beads PRs (no new activity)\n"}
{"author":"gastown/crew/max","created_at":"2026-02-28T03:10:12Z","id":11,"issue_id":"gt-pr-sheriff","text":"## Sheriff Run 2026-02-27 (Run 3)\n\n**Easy-wins merged**: 1\n- PR #2128 (sho-muc): feat(daemon) add gt daemon clear-backoff — squash merged\n\n**Needs rebase**: 1\n- PR #2136 (DreadPirateRobertz): merge conflicts\n\n**Assigned to crew**: 5\n- PR #2134 → mel: doctor beads redirect repair\n- PR #2125 → dennis: mail idle-first nudge\n- PR #2114 → gus: convoy recovery sweep\n- PR #2088 → joe: multi-socket quota scan\n- PR #2008 → tom: re-review context-budget tap guard (new commits)\n\n**Re-check prior assignments**: 2\n- PR #2018 → jack (from run 1)\n- PR #2081 → george (from run 1)\n\n**Left for human**: 2\n- PR #2132 (rsionnach): Guardian Phase 1 — 2623 lines, new package\n- PR #2068 (pae23): OTel telemetry — 2353 lines, 29 files\n\n**Skipped (draft)**: 5\n"}
{"author":"gastown/crew/max","created_at":"2026-03-01T17:54:17Z","id":12,"issue_id":"gt-t2nt","text":"## Stress Test Report: Merge Queue + Formula v7\n\n### Setup\n- Created convoy hq-cv-r8b with 7 tracked issues\n- Launched FIX SWARM: 4 ZFC bugs (gt-5rne, gt-tsut, gt-mcw2, gt-utuk)\n- Launched CODE REVIEW SWARM: 3 reviews (gt-v95d witness, gt-d4fy refinery, gt-71dk polecat)\n- Peak: 9 polecats running simultaneously\n\n### Timeline\n- T+0m: Swarm launched. 8 polecats spawned (gt-mcw2 already hooked by nux)\n- T+2m: 9 polecats active. Dolt: 0s latency, 5 conns\n- T+4m: All still working. Dolt: 0s latency, 3 conns\n- T+7m: 3/7 complete: code reviews gt-71dk, gt-d4fy done. Polecats self-cleaned\n- T+10m: 6/7 complete. Only gt-tsut remaining\n- T+17m: gt-tsut analysis done but code not implemented. Slit self-cleaned\n- T+20m: All polecats gone. Convoy at 6/7\n\n### Results by Issue\n\nFIX SWARM (4 ZFC bugs):\n- gt-mcw2 (nux, ~2m): Closed, no code changes. Analyzed boot triage decision tree.\n- gt-5rne (furiosa, ~10m): Closed, reports removing 3 ZFC violations. No branch/MR visible. Possible self-clean data loss.\n- gt-utuk (rictus, ~9m): Closed, previous session already fixed. Documented remaining violations.\n- gt-tsut (slit, ~17m): Analysis complete, bead still open. Documented fix plan but didn't implement.\n\nCODE REVIEW SWARM (3 reviews):\n- gt-71dk polecat review (toast, ~5m): 7 issues found. Verdict: well-engineered.\n- gt-d4fy refinery review (cheedo, ~5m): No correctness bugs, 3 minor improvements. Verdict: sound.\n- gt-v95d witness review (valkyrie, ~6m): 1 HIGH bug (gt-io6v), 3 P2, 2 P3. Filed 6 beads. Verdict: well-structured.\n\n### Formula v7 Performance\n- Code reviews: 5-7 minutes including self-clean\n- Analysis-only fixes: 2-10 minutes with self-clean\n- No full test suite bottleneck — build-only check worked as designed\n- Self-cleaning reliable across all 9 polecats\n\n### MQ / Batching / Bisection\n- No MRs entered the merge queue — all fixes were analysis-only or already-fixed\n- Cannot evaluate batching/bisection — no MRs produced\n- MQ not truly stress-tested for core functionality\n\n### Dolt Health\n- Rock solid: 0s query latency at all checkpoints\n- Connections: peaked at 6/1000, settled to 4\n- Disk: 486 MB -\u003e 505 MB peak -\u003e 496 MB after cleanup\n- Net disk growth: ~10 MB for entire swarm\n- 2 orphaned DBs detected (pre-existing, not from swarm)\n\n### Key Findings\n1. Formula v7 speed confirmed — polecats complete significantly faster\n2. Self-cleaning reliable — all 9 polecats cleaned up properly\n3. Dolt handles 9 concurrent polecats without stress — 0s latency throughout\n4. gt-5rne possible data loss — investigate self-clean vs push race\n5. MQ not truly stress-tested — need tasks guaranteed to produce code changes\n\n### Recommendations\n1. Investigate gt-5rne: did furiosa push before self-cleaning?\n2. Re-sling gt-tsut with explicit implement instructions\n3. For proper MQ stress test, sling mechanical tasks guaranteed to produce changes\n4. Code reviews produced 6 new bugs from gt-v95d alone — good ROI\n"}
